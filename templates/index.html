<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Viewer and Email Sender</title>
    <!-- Include Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1>CSV Viewer and Email Sender</h1>
        
        <!-- Render the filter form -->
        <form method="POST" action="{{ url_for('index') }}">
            {{ form.hidden_tag() }}
            <div class="mb-3">
                {{ form.column_name.label }} {{ form.column_name(class="form-control") }}
            </div>
            <div class="mb-3">
                {{ form.filter_value.label }} {{ form.filter_value(class="form-control") }}
            </div>
			
            {{ form.submit(class="btn btn-primary") }}
        </form>
        
        <!-- Render the data table and email form -->
        <form method="POST" action="{{ url_for('send_emails') }}">
            <table class="table">
                <thead>
                    <tr>
                        <th>Select</th>
                        <!-- Replace 'column1', 'column2', etc. with your actual column names -->
						<th>Id</th>
						<th>Email</th>
						<th>Patient_Full_Name</th>
						<th>First_Name</th>
						<th>Last_Name</th>
						<th>Chosen_First_Name</th>
						<th>Chosen_Last_Name</th>
						<th>Pronouns</th>
						<th>Sex</th>
						<th>Gender_Identity</th>
						<th>Date_of_Birth</th>
						<th>Age</th>
						<th>Status</th>
						<th>Membership_Plan</th>
						<th>Membership_Start_Date</th>
						<th>Membership_Rate</th>
						<th>Membership_Id</th>
						<th>Membership_Billing_Period</th>
						<th>Billing_Period_in_Months</th>
						<th>Membership_Next_Bill_Date</th>
						<th>Membership_Last_Billed_On</th>
						<th>Membership_End_Date</th>
						<th>Membership_Cancellation_Reason</th>
						<th>Member_Type</th>
						<th>Membership_Owner_Id</th>
						<th>Membership_Owner_Name</th>
						<th>Autopay</th>
						<th>Payment_Method</th>
						<th>Payment_Last_Four</th>
						<th>Joined_Practice</th>
						<th>City</th>
						<th>Zip_Code</th>
						<th>Created_At</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in data %}
                    <tr>
                        <td><input type="checkbox" name="email" value="{{ row['Email'] }}"></td>
                        <!-- Replace 'row.column1', 'row.column2', etc. with your actual column names -->
                        <td>{{ row['Id'] }}</td>
						<td>{{ row['Email'] }}</td>
						<td>{{ row['Patient Full Name'] }}</td>
						<td>{{ row['First Name'] }}</td>
						<td>{{ row['Last Name'] }}</td>
						<td>{{ row['Chosen First Name'] }}</td>
						<td>{{ row['Chosen Last Name'] }}</td>
						<td>{{ row['Pronouns'] }}</td>
						<td>{{ row['Sex'] }}</td>
						<td>{{ row['Gender Identity'] }}</td>
						<td>{{ row['Date of Birth'] }}</td>
						<td>{{ row['Age'] }}</td>
						<td>{{ row['Status'] }}</td>
						<td>{{ row['Membership Plan'] }}</td>
						<td>{{ row['Membership Start Date'] }}</td>
						<td>{{ row['Membership Rate'] }}</td>
						<td>{{ row['Membership Id'] }}</td>
						<td>{{ row['Membership Billing Period'] }}</td>
						<td>{{ row['Billing Period in Months'] }}</td>
						<td>{{ row['Membership Next Bill Date'] }}</td>
						<td>{{ row['Membership Last Billed On'] }}</td>
						<td>{{ row['Membership End Date'] }}</td>
						<td>{{ row['Membership Cancellation Reason'] }}</td>
						<td>{{ row['Member Type'] }}</td>
						<td>{{ row['Membership Owner Id'] }}</td>
						<td>{{ row['Membership Owner Name'] }}</td>
						<td>{{ row['Autopay'] }}</td>
						<td>{{ row['Payment Method'] }}</td>
						<td>{{ row['Payment Last Four'] }}</td>
						<td>{{ row['Joined Practice'] }}</td>
						<td>{{ row['City'] }}</td>
						<td>{{ row['Zip Code'] }}</td>
						<td>{{ row['Created At'] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            <button type="submit" class="btn btn-primary">Send Emails</button>
        </form>
    </div>
</body>
</html>